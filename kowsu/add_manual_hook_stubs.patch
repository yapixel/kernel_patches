commit d91910a40119e75c52e213ca1d661ebdeab371c0
Author: debiansid <debiansid@gmail.com>
Date:   Thu Oct 30 15:22:57 2025 +0800

    [PATCH] Add minimal manual hook stubs for min_scope_syscall_hooks

diff --git a/kernel/ksud.c b/kernel/ksud.c
index b96c5ff9..074e9df7 100644
--- a/kernel/ksud.c
+++ b/kernel/ksud.c
@@ -57,6 +57,22 @@ bool ksu_input_hook __read_mostly = true;
 #endif
 bool ksu_execveat_hook __read_mostly = true;
 
+// === Minimal Manual Syscall Hook Stubs ===
+// Required by min_scope_syscall_hooks_v1.5.patch when CONFIG_KSU_KPROBES_HOOK=n
+
+int ksu_handle_sys_read(unsigned int fd, char __user *buf, size_t count)
+{
+	return 0;
+}
+EXPORT_SYMBOL(ksu_handle_sys_read);
+
+int ksu_handle_input_handle_event(struct input_handle *handle,
+				  unsigned int type, unsigned int code, int value)
+{
+	return 0;
+}
+EXPORT_SYMBOL(ksu_handle_input_handle_event);
+
 u32 ksu_devpts_sid;
 
 void on_post_fs_data(void)
