diff --git a/kernel/app_profile.c b/kernel/app_profile.c
index 2369abbc..336d8e7f 100644
--- a/kernel/app_profile.c
+++ b/kernel/app_profile.c
@@ -11,7 +11,11 @@
 #include "app_profile.h"
 #include "klog.h" // IWYU pragma: keep
 #include "selinux/selinux.h"
+#ifndef CONFIG_KSU_SUSFS
 #include "syscall_hook_manager.h"
+#endif // #ifndef CONFIG_KSU_SUSFS
+
+#define KERNEL_SU_DOMAIN "u:r:su:s0"
 
 static struct group_info root_groups = { .usage = ATOMIC_INIT(2) };
 
@@ -76,8 +78,10 @@ static void disable_seccomp(void)
 void escape_with_root_profile(void)
 {
 	struct cred *cred;
+#ifndef CONFIG_KSU_SUSFS
 	struct task_struct *p = current;
 	struct task_struct *t;
+#endif // #ifndef CONFIG_KSU_SUSFS
 
 	cred = prepare_creds();
 	if (!cred) {
@@ -128,8 +132,14 @@ void escape_with_root_profile(void)
 	spin_unlock_irq(&current->sighand->siglock);
 
 	setup_selinux(profile->selinux_domain);
-
+#ifndef CONFIG_KSU_SUSFS
 	for_each_thread (p, t) {
 		ksu_set_task_tracepoint_flag(t);
 	}
+#endif // #ifndef CONFIG_KSU_SUSFS
 }
+
+void __maybe_unused escape_to_root_for_init(void)
+{
+setup_selinux(KERNEL_SU_DOMAIN);
+}
diff --git a/kernel/app_profile.h b/kernel/app_profile.h
index 047ed9f9f0..5b6b4496fc 100644
--- a/kernel/app_profile.h
+++ b/kernel/app_profile.h
@@ -63,4 +63,5 @@ 
 // Escalate current process to root with the appropriate profile
 void escape_with_root_profile(void);
 
+void escape_to_root_for_init(void);
 #endif
