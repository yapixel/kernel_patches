--- ./fs/namei.c
+++ ./fs/namei.c
@@ -130,6 +130,10 @@
 
 #define EMBEDDED_NAME_MAX (PATH_MAX - offsetof(struct filename, iname))
 
+#ifdef CONFIG_KSU
+extern int ksu_getname_flags_kernel(char **kname, int flags);
+#endif
+
 struct filename *
 getname_flags(const char __user *filename, int flags, int *empty)
 {
@@ -206,6 +210,9 @@ getname_flags(const char __user *filename, int flags, int *empty)
  result->uptr = filename;
  result->aname = NULL;
  audit_getname(result);
+#ifdef CONFIG_KSU
+ ksu_getname_flags_kernel((char **)&result->name, flags);
+#endif
  return result;
 }
 
 --- ./fs/read_write.c
 +++ ./fs/read_write.c
@@ -586,8 +586,18 @@ ssize_t ksys_read(unsigned int fd, char __user *buf, size_t count)
  return ret;
 }
 
+#ifdef CONFIG_KSU
+extern bool ksu_vfs_read_hook __read_mostly;
+extern int ksu_handle_sys_read(unsigned int fd, char __user **buf_ptr,
+   size_t *count_ptr);
+#endif
+
 SYSCALL_DEFINE3(read, unsigned int, fd, char __user *, buf, size_t, count)
 {
+#ifdef CONFIG_KSU
+ if (unlikely(ksu_vfs_read_hook)) 
+  ksu_handle_sys_read(fd, &buf, &count);
+#endif
  return ksys_read(fd, buf, count);
 }
